<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Avatar - Voice Conversation</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Azure Avatar</h1>
            <p class="subtitle">Real-time voice conversation with AI</p>
        </header>

        <!-- Configuration Section -->
        <details class="config-section" id="configSection">
            <summary>
                <span class="config-title">‚öôÔ∏è Configuration</span>
                <span class="config-hint">Click to expand</span>
            </summary>
            
            <div class="config-content">
                <div class="config-group">
                    <h3>Azure Speech Service</h3>
                    <div class="form-group">
                        <label for="speechKey">Speech Key:</label>
                        <input type="password" id="speechKey" placeholder="Enter your Azure Speech key">
                    </div>
                    <div class="form-group">
                        <label for="speechRegion">Speech Region:</label>
                        <select id="speechRegion">
                            <option value="westus2">West US 2</option>
                            <option value="westeurope">West Europe</option>
                            <option value="southeastasia">Southeast Asia</option>
                        </select>
                    </div>
                </div>

                <div class="config-group">
                    <h3>Azure OpenAI Service</h3>
                    <div class="form-group">
                        <label for="openaiEndpoint">OpenAI Endpoint:</label>
                        <input type="text" id="openaiEndpoint" placeholder="https://your-resource.openai.azure.com">
                    </div>
                    <div class="form-group">
                        <label for="openaiKey">OpenAI Key:</label>
                        <input type="password" id="openaiKey" placeholder="Enter your Azure OpenAI key">
                    </div>
                    <div class="form-group">
                        <label for="openaiDeployment">Deployment Name:</label>
                        <input type="text" id="openaiDeployment" placeholder="gpt-4o" value="gpt-4o">
                    </div>
                </div>

                <div class="config-group">
                    <h3>Avatar Settings</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="avatarCharacter">Character:</label>
                            <select id="avatarCharacter">
                                <option value="lisa">Lisa</option>
                                <option value="harry">Harry</option>
                                <option value="jenny">Jenny</option>
                                <option value="max">Max</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="avatarStyle">Style:</label>
                            <select id="avatarStyle">
                                <option value="casual-sitting">Casual Sitting</option>
                                <option value="graceful-sitting">Graceful Sitting</option>
                                <option value="technical-sitting">Technical Sitting</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="voiceName">Voice:</label>
                        <select id="voiceName">
                            <option value="en-US-AvaMultilingualNeural">Ava (Multilingual)</option>
                            <option value="en-US-AndrewMultilingualNeural">Andrew (Multilingual)</option>
                            <option value="en-US-EmmaMultilingualNeural">Emma (Multilingual)</option>
                            <option value="en-US-BrianMultilingualNeural">Brian (Multilingual)</option>
                            <option value="en-US-JennyNeural">Jenny</option>
                            <option value="en-US-GuyNeural">Guy</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="systemPrompt">System Prompt:</label>
                        <textarea id="systemPrompt" rows="3" placeholder="Define the avatar's personality...">You are a friendly and helpful AI assistant. Keep your responses concise and conversational, typically 1-3 sentences. Be warm and engaging.</textarea>
                    </div>
                </div>
            </div>
        </details>

        <!-- Avatar Display Section -->
        <div class="avatar-section">
            <div class="video-container" id="videoContainer">
                <div class="placeholder" id="placeholder">
                    <div class="placeholder-icon">üé≠</div>
                    <p>Click "Start Avatar" to begin</p>
                </div>
                <video id="videoPlayer" autoplay playsinline></video>
                <audio id="audioPlayer" autoplay></audio>
                
                <!-- Conversation indicator -->
                <div class="conversation-indicator" id="conversationIndicator">
                    <div class="indicator-content">
                        <div class="listening-waves" id="listeningWaves">
                            <span></span><span></span><span></span><span></span><span></span>
                        </div>
                        <span id="indicatorText">Ready</span>
                    </div>
                </div>
            </div>
            
            <!-- Main Controls -->
            <div class="main-controls">
                <button id="startButton" class="btn btn-primary">
                    <span class="btn-icon">‚ñ∂Ô∏è</span>
                    Start Avatar
                </button>
                <button id="stopButton" class="btn btn-secondary" disabled>
                    <span class="btn-icon">‚èπÔ∏è</span>
                    Stop
                </button>
            </div>

            <!-- Voice Conversation Controls -->
            <div class="voice-controls" id="voiceControls">
                <div class="voice-mode-toggle">
                    <button id="pushToTalkBtn" class="btn btn-voice" disabled>
                        <span class="btn-icon">üé§</span>
                        <span class="btn-label">Hold to Talk</span>
                    </button>
                    <button id="continuousBtn" class="btn btn-voice-secondary" disabled>
                        <span class="btn-icon">üîÑ</span>
                        <span class="btn-label">Continuous</span>
                    </button>
                </div>
                <p class="voice-hint" id="voiceHint">Start the avatar first, then use voice controls</p>
            </div>

            <!-- Status Bar -->
            <div class="status-bar">
                <div class="status-item">
                    <span class="status-indicator" id="avatarStatus"></span>
                    <span id="avatarStatusText">Avatar: Disconnected</span>
                </div>
                <div class="status-item">
                    <span class="status-indicator" id="micStatus"></span>
                    <span id="micStatusText">Mic: Off</span>
                </div>
            </div>
        </div>

        <!-- Text Input Section (Alternative to voice) -->
        <details class="text-section">
            <summary>
                <span>üí¨ Text Input (Alternative)</span>
            </summary>
            <div class="text-content">
                <div class="form-group">
                    <textarea id="textInput" rows="2" placeholder="Type a message instead of speaking..."></textarea>
                </div>
                <button id="sendTextBtn" class="btn btn-send" disabled>Send</button>
            </div>
        </details>

        <!-- Conversation History -->
        <div class="history-section" id="historySection">
            <h3>Conversation</h3>
            <div class="conversation-log" id="conversationLog">
                <p class="empty-state">Conversation will appear here...</p>
            </div>
            <button id="clearHistoryBtn" class="btn btn-text">Clear History</button>
        </div>

        <!-- Info Section -->
        <div class="info-section">
            <h3>Quick Start</h3>
            <ol>
                <li>Enter your <strong>Azure Speech</strong> key and region</li>
                <li>Enter your <strong>Azure OpenAI</strong> endpoint, key, and deployment name</li>
                <li>Click <strong>Start Avatar</strong></li>
                <li>Use <strong>Hold to Talk</strong> or enable <strong>Continuous</strong> mode</li>
            </ol>
            <p class="info-note">üí° Tip: Hold the spacebar as a shortcut for push-to-talk!</p>
        </div>
    </div>

    <!-- Azure Speech SDK -->
    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>
    <script src="app.js"></script>
</body>
</html>
