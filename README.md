# Azure Avatar - Real-time Voice Conversation

A web application for real-time voice conversations with Microsoft Azure's Text to Speech Avatar, powered by Azure OpenAI.

## Features

- ðŸŽ¤ **Voice Input** - Talk to the avatar using your microphone
- ðŸ¤– **AI-Powered** - Responses generated by Azure OpenAI (GPT-4o)
- ðŸŽ­ **Real-time Avatar** - Photorealistic avatar speaks responses
- ðŸ’¬ **Text Alternative** - Type messages if you prefer
- ðŸ”„ **Continuous Mode** - Hands-free conversation

## Prerequisites

You need **two Azure resources**:

### 1. Azure Speech Service

| Requirement | Details |
|-------------|---------|
| Pricing Tier | **Standard S0** (required for avatars) |
| Supported Regions | `westus2`, `westeurope`, `southeastasia` |

**Setup:**
1. Go to [Azure Portal](https://portal.azure.com)
2. Create a **Speech** resource
3. Select **Standard S0** pricing tier
4. Choose a supported region
5. After deployment, copy your **Key** and **Region**

### 2. Azure OpenAI Service

| Requirement | Details |
|-------------|---------|
| Model | GPT-4o, GPT-4, or GPT-3.5-turbo |
| Deployment | Create a deployment with your chosen model |

**Setup:**
1. Go to [Azure Portal](https://portal.azure.com)
2. Create an **Azure OpenAI** resource
3. Go to [Azure OpenAI Studio](https://oai.azure.com/)
4. Deploy a model (e.g., `gpt-4o`)
5. Copy your:
   - **Endpoint** (e.g., `https://your-resource.openai.azure.com`)
   - **API Key**
   - **Deployment Name** (e.g., `gpt-4o`)

## Running the Demo

### Option 1: Python HTTP Server

```bash
cd /path/to/mcavatar
python3 -m http.server 8080
```

Open http://localhost:8080

### Option 2: Node.js

```bash
npx serve .
```

### Option 3: VS Code Live Server

Right-click `index.html` â†’ "Open with Live Server"

## Usage

### Quick Start

1. **Configure** - Expand the configuration section and enter:
   - Azure Speech key and region
   - Azure OpenAI endpoint, key, and deployment name

2. **Start Avatar** - Click the "Start Avatar" button

3. **Talk** - Use one of these methods:
   - **Hold to Talk**: Click and hold the green button
   - **Spacebar**: Press and hold spacebar (shortcut)
   - **Continuous Mode**: Click "Continuous" for hands-free

4. **Wait for Response** - The avatar will speak the AI's response

### Voice Modes

| Mode | How to Use | Best For |
|------|------------|----------|
| Push-to-Talk | Hold button or spacebar | Short questions |
| Continuous | Toggle on, speak freely | Long conversations |
| Text Input | Expand text section, type | Noisy environments |

### Conversation Indicators

| Indicator | Meaning |
|-----------|---------|
| ðŸŸ¢ Green border | Listening to you |
| ðŸŸ¡ Yellow border | Processing/thinking |
| ðŸ”µ Blue border | Avatar speaking |

## Available Avatars

| Character | Styles |
|-----------|--------|
| Lisa | casual-sitting, graceful-sitting, technical-sitting |
| Harry | casual-sitting, graceful-sitting, technical-sitting |
| Jenny | casual-sitting, graceful-sitting |
| Max | casual-sitting, graceful-sitting |

## Available Voices

- **Ava** (Multilingual) - `en-US-AvaMultilingualNeural`
- **Andrew** (Multilingual) - `en-US-AndrewMultilingualNeural`
- **Emma** (Multilingual) - `en-US-EmmaMultilingualNeural`
- **Brian** (Multilingual) - `en-US-BrianMultilingualNeural`
- **Jenny** - `en-US-JennyNeural`
- **Guy** - `en-US-GuyNeural`

## Customizing the AI Personality

Edit the **System Prompt** in the configuration to change how the avatar responds:

```
You are a friendly customer service representative for Contoso. 
Be helpful, professional, and keep responses under 2 sentences.
```

## Troubleshooting

### "Failed to fetch ICE credentials"
- Verify your Speech key is correct
- Ensure region matches your Speech resource
- Confirm you're using Standard S0 tier

### "OpenAI API error"
- Check your endpoint URL format: `https://YOUR-RESOURCE.openai.azure.com`
- Verify API key is correct
- Confirm deployment name matches exactly

### Microphone not working
- Allow microphone permission in browser
- Check that no other app is using the mic
- Try refreshing the page

### Avatar doesn't appear
- Use a supported browser (Chrome/Edge recommended)
- Check browser console for errors
- Ensure WebRTC is not blocked

## Technical Details

- **Speech Recognition**: Azure Speech SDK (continuous recognition)
- **AI**: Azure OpenAI Chat Completions API
- **Avatar**: Azure Text to Speech Avatar with WebRTC streaming
- **Frontend**: Vanilla JavaScript, HTML5, CSS3

## Supported Browsers

| Platform | Chrome | Edge | Safari | Firefox |
|----------|--------|------|--------|---------|
| Windows  | âœ… | âœ… | N/A | âœ… |
| macOS    | âœ… | âœ… | âœ… | âœ… |
| iOS      | âœ… | âœ… | âœ… | âœ… |
| Android  | âœ… | âœ… | N/A | âœ… |

## Limitations

- Avatar auto-disconnects after **5 minutes idle** or **30 minutes total**
- Continuous mode pauses during avatar speech
- One conversation at a time

## Resources

- [Text to Speech Avatar Documentation](https://learn.microsoft.com/en-us/azure/ai-services/speech-service/text-to-speech-avatar/real-time-synthesis-avatar)
- [Azure OpenAI Documentation](https://learn.microsoft.com/en-us/azure/ai-services/openai/)
- [Speech SDK Reference](https://docs.microsoft.com/javascript/api/microsoft-cognitiveservices-speech-sdk/)

## Cost Considerations

| Service | Pricing |
|---------|---------|
| Speech (S0) | ~$1 per hour of avatar video |
| OpenAI (GPT-4o) | ~$5 per 1M input tokens, ~$15 per 1M output tokens |

Estimate: A 10-minute conversation costs approximately $0.20-0.50

---

Built with Azure AI Services ðŸš€
